# Committer: haru <haru@nak.ics.keio.ac.jp>

pkgname=screen-patch
pkgver=4.0.2
pkgrel=1
_ptygroup=5
pkgdesc="Full-screen window manager that multiplexes a physical terminal"
arch=('i686')
url="http://www.gnu.org/software/screen/"
license=('GPL')
depends=('ncurses' 'pam')
backup=('etc/screenrc')
source=('http://ftp.gnu.org/gnu/screen/screen-4.0.2.tar.gz'
	'http://www.dekaino.net/screen/screen-4.0.2-deadlock-patch'
	'http://www.dekaino.net/screen/screen-4.0.2-hankanacopy-patch'
	'http://www.dekaino.net/screen/screen-4.0.2-patch-cjkwidth-cvs-2006052001'
	'screen.pam')
md5sums=('ed68ea9b43d9fba0972cb017a24940a1'
	'64d3d365c03c4c41bfde35c907ec0e57'
	'8e970964b3bfbea1a94ab75385d4434b'
	'617eceafee19050991eff2f1cb448c50'
	'74f7919d7b65436cc2ea5341fa8ca374')

build() {
	cd ${srcdir}/screen-${pkgver}
	patch -p 0 < ../screen-4.0.2-hankanacopy-patch
	patch -p 0 < ../screen-4.0.2-deadlock-patch
	patch -p 0 < ../screen-4.0.2-patch-cjkwidth-cvs-2006052001
	./configure --prefix=/usr/local --enable-pam \
		--with-sys-screenrc=/etc/screenrc --enable-colors256 \
		--enable-rxvt_osc --with-pty-group=$_ptygroup \
		--mandir=/usr/local/share/man --infodir=/usr/share/info
	make -j3
	make DESTDIR=${pkgdir} install

	install -Dm644 ${srcdir}/screen.pam ${pkgdir}/etc/pam.d/screen
	install -Dm644 etc/etcscreenrc ${pkgdir}/etc/screenrc
	install -Dm644 etc/screenrc ${pkgdir}/etc/skel/.screenrc
}
