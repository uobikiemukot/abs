cxfe - a console xine frontend
by Rett D. Walters

This code is distributed under the GNU General Public License

This frontend is intended to be used by applications
that need a lightweight shellable/scriptable non-X11 based
interface to the xine library.  It supports the following
Xine lib video drivers: xshm, dxr3, fb, xv.  Applications
currently known to make use of cxfe are:

mmsv2 - mms.sunsite.dk  (DXR3 and FB Menu System)

installation:

untar the archive
In the extracted directory type:

./configure 
make
make install

now type 

cxfe mrl://to/some/stream -vo <driver> [-ao <driver>] [-i <input option>]  
       [-dev <input device>] [-fs] [-d] [-p <post deinterlace plugin 
       string>] [-v] [-h]
   
Will begin playing stream to selected video device and audio device. DXR3 May
only work with MPEG1/2 source files at the moment.  

Parameters can be supplied in any order.

MRL examples:

/root/test12.mpg        (Play this file)
dvd:/1			(Play 1st title on DVD)	
vcd:/1 			(Play 1st title on VCD)

Example - The following example will play the 1st title on
a DVD, and using Xshm for video, and alsa for audio, from /dev/dvd1.

cxfe dvd:/1 -vo xshm -ao alsa -dev /dev/dvd1

Multiple MRLs can now be supplied on the command line, creating a 
pseudo playlist feature.  cxfe supports up to 1000 MRLs. cxfe will begin
with the first MRL found on the command line.  Using the s key command
will skip from the current MRL to the next MRL. If no more MRLs are
present, then the s key will cause cxfe to exit.

Notes:

-ao, -dev parameters are optional.  -dev defaults to 
values in the xine config file for mrl type specified (usually in 
~/.xine/config, see below) if not supplied.  

-h = print help screen, then exit
-v = print version, then exit
-fs = start in fullscreen mode
-d  = turn on deinterlacing at start using -p post plugin or default 
      deinterlacing plugin
-p  = set custom deinterlacing post plugin - If parameters following -p 
      are not valid xine post string (see below) cxfe will fall back to 
      legacy xine deinterlacing, shutting off advanced post

Tested Video Out drivers:

xv = X Video
xshm = X shared memory
dxr3 = DXR3 Card
fb = framebuffer

Tested Audio Out drivers:

oss
alsa

The -i parameter is optional and currently supports two values:  kybd 
(default), and lirc.  Lirc support is currently limited to a few commands.
See LIRC section below.

Cxfe reads the xine configuration file, usually located in ~/.xine/config.  
Documentation for this file can be found at http://xinehq.de

Key Commands:

Space Bar - Pauses playback
Right Arrow - seek ~60s forward
Left Arrow - seek ~15s backward
q - quits
Up Arrow - increases Volume
Down Arrow - decrease Volume
f - Full Screen/Window Toggle (X only)
d - Toggle Deinterlace/post processing (uses default or post set with
    -p switch)
s - Skip to next MRL if multiple MRLS supplied.  If only one
mrl is supplied this will exit the program

The following key commands may not work on all vo plugins:

1,2 Increase/Decrease Contrast
3,4 Increase/Decrease Brightness
5,6 Increase/Decrease Saturation
7,8 Increase/Decrease Hue
a   Change Aspect Ratio
z/Z Zoom In/Out
 
 
The following key commands will work only with dvd/vcd mrls:

PgDN - Next Chapter
PgUP - Previous Chapter

The following key commands are used with DVD menus

F1 - Toggle movie and DVD menu
F2 - Go to Title Menu (first menu on DVD)
F3 - Go to Root menu 
F4 - Go to Subtitles Menu
F5 - Go to Audio Menu
i,I - Move menu selection up
k,K - Move menu selection right
j,J - Move menu selection left
m,M - Move menu selection down
ENTER - Make selection

Some DVDs differ as to what is available in regards to menu options.

LIRC Information

A sample .lircrc file is provided in the source distribution.
This file should be copied to the user's home directory. cxfe
will look in the users homedir then $PREFIX/share/cxfe/lircrc for 
LIRC configuration. Future versions of cxfe will add support for
more RC commands.  Currently supported commands are as follows:

For DVD MRLs:

Menu Up
Menu Down
Menu Left
Menu Right
Menu Select
Next Chapter
Previous Chapter
5 Menu Levels

For All MRLs:

Play
Pause 
Stop/skip to next MRL
Quit
FastForward
Rewind
Aspect Change (xv, xshm, fb only)

Deinterlacing/Post processing functions:

Cxfe now supports xine-lib advanced post processing functions for
deinterlacing video streams.  Xine-lib includes support for tvtime 
deinterlacers which provide excellent quality.  The default deinterlacer
for cxfe shown below (syntax is standard xine-ui/xine-lib)

tvtime:method=LinearBlend,cheap_mode=1,pulldown=0,use_progressive_frame_flag=1

This plugin provides basic deinterlacing with minimal CPU usage.

A more advanced deinterlace plugin would be:

tvtime:method=greedy2frame,enabled=1,pulldown=none,framerate_mode=full
              ,judder_correction=0,cheap_mode=0

This will provide the best quality deinterlacing, but uses alot of CPU.

Deinterlace settings/switches are ignored when using the DXR3 vo driver.
DXR3 cards handle interlaced video properly without special processing.

System requirements:

xine-lib-1-rc3 or better (xine-lib-1-rc7 recommended)
X11 and X development libs installed on system
Working DXR3 installation for DXR3 support

Credits:

Portions from the xine frontend package "sxfe" and from the xine hackers 
guide at xine.sf.net.
Console Keyboard input code by A'rpi/ESP Team, (mplayer project)

TODO:

Fix/implement video and audio driver selection  *DONE*
Implement more keyboard control  *In progess* 
Implement keyboard command customization *In progress* 
Implement LIRC control  *In progress*
Implement Autoconf/Automake for build process *In Progress*
Implement OSD *DONE* 
Implement DVD/CD/VCD device parameter selection *DONE*
Implement Post processing features of Xine lib for deinterlacing *In Progress* 
Implement multiple MRL input *DONE*
Modularize Source Files *In Progress*

Known issues:

FB mode only works in 16 bit color mode - this is a limitation of xine-lib
Seeking forward/backward isn't always accurate - this is a limitation of
xine-lib.

There may be issues playing certain Xvid files.  This is a limitation of
xine-lib and related to the ffmpeg decoder included with xine-lib.

Special demuxer parameters are needed in the MRL (append 
#demux:<demuxer>) for proper playback of MPEG 2 PS streams 
created by IVTV on a WINTV PVR 250/350 card.  The rc4a version of
xine-lib does not properly detect the stream type.  This is fixed
in xine-lib rc5 and higher. 

Post processing support is currently limited to deinterlacing with -d/-p 
switches or d keypress. Goom or other SFX plugins are not supported.

Have Fun!

--
Rett
+-----------------+----------------+
| rettw@rtwnetwork.com             |
+-----------------+----------------+
