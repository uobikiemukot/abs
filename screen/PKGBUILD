# Committer: haru <haru@nak.ics.keio.ac.jp>

pkgname=screen-unicode
pkgver=4.1.0
pkgrel=1
_ptygroup=5 #the UID of our PTY/TTY group
pkgdesc="Full-screen window manager that multiplexes a physical terminal"
arch=('i686')
url="http://www.gnu.org/software/screen/"
license=('GPL')
depends=('ncurses' 'pam')
backup=('etc/screenrc' 'etc/pam.d/screen')
options=('!makeflags')
install=screen.install
source=('http://git.savannah.gnu.org/cgit/screen.git/snapshot/screen-8cf5efc07048abee125a24652768f4b24fc761bf.tar.gz'
	'screen.pam')
md5sums=('616153d09e56d20dd7ed8323a49ee821'
         '74f7919d7b65436cc2ea5341fa8ca374')

build() {
  export LDFLAGS="${LDFLAGS} -Wl,--as-needed"

  cd ${srcdir}/screen-8cf5efc07048abee125a24652768f4b24fc761bf/src
  ./autogen.sh
  ./configure --prefix=/usr/local --enable-pam \
        --with-sys-screenrc=/etc/screenrc --enable-colors256 \
       --enable-rxvt_osc --with-pty-group=$_ptygroup \
       --mandir=/usr/local/share/man --infodir=/usr/share/info
  make -j3 || return 1
  make DESTDIR=${pkgdir} install || return 1
  install -Dm644 ${srcdir}/screen.pam ${pkgdir}/etc/pam.d/screen

  #install -Dm644 etc/completer.zsh ${pkgdir}/usr/share/zsh/site-functions/screen
  install -Dm644 etc/etcscreenrc ${pkgdir}/etc/screenrc
  install -Dm644 etc/screenrc ${pkgdir}/etc/skel/.screenrc

  rm ${pkgdir}/usr/share/info/dir
  gzip -9 ${pkgdir}/usr/share/info/*
}
